docker run -e PYTHONPATH=/app -e ENVIRONMENT=test -v /mnt/d/Coding/Bonch/BOT_VK/bot-starostat-fastapi/src:/app --rm starostat-bot/fastapi:1.0.0-dev make pytest
python -m pytest -c configs/pytest.ini app/
============================= test session starts ==============================
platform linux -- Python 3.11.3, pytest-7.4.3, pluggy-1.3.0 -- /usr/local/bin/python
cachedir: .pytest_cache
rootdir: /app/configs
configfile: pytest.ini
plugins: cov-4.1.0, asyncio-0.21.1, lazy-fixtures-1.0.1, mock-3.12.0, anyio-3.7.1
asyncio: mode=Mode.AUTO
collecting ... collected 93 items

configs/bot/tests/test_broadcast.py::test_sharing_text[broadcast_result0-\u0420\u0430\u0441\u0441\u044b\u043b\u043a\u0430 \u0443\u0441\u043f\u0435\u0448\u043d\u043e \u043e\u0442\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u0430!\n\n\u041a\u0443\u0440\u0441 1 \u0444\u0430\u043a\u0443\u043b\u044c\u0442\u0435\u0442 \u0420\u0422\u0421: +\n\u041a\u0443\u0440\u0441 2 \u0444\u0430\u043a\u0443\u043b\u044c\u0442\u0435\u0442 \u0420\u0422\u0421: +\n\u041a\u0443\u0440\u0441 3 \u0444\u0430\u043a\u0443\u043b\u044c\u0442\u0435\u0442 \u0420\u0422\u0421: +-message_simple] <- ../app/bot/tests/test_broadcast.py PASSED [  1%]
configs/bot/tests/test_broadcast.py::test_sharing_text[broadcast_result0-\u0420\u0430\u0441\u0441\u044b\u043b\u043a\u0430 \u0443\u0441\u043f\u0435\u0448\u043d\u043e \u043e\u0442\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u0430!\n\n\u041a\u0443\u0440\u0441 1 \u0444\u0430\u043a\u0443\u043b\u044c\u0442\u0435\u0442 \u0420\u0422\u0421: +\n\u041a\u0443\u0440\u0441 2 \u0444\u0430\u043a\u0443\u043b\u044c\u0442\u0435\u0442 \u0420\u0422\u0421: +\n\u041a\u0443\u0440\u0441 3 \u0444\u0430\u043a\u0443\u043b\u044c\u0442\u0435\u0442 \u0420\u0422\u0421: +-message_with_reply] <- ../app/bot/tests/test_broadcast.py PASSED [  2%]
configs/bot/tests/test_broadcast.py::test_sharing_text[broadcast_result0-\u0420\u0430\u0441\u0441\u044b\u043b\u043a\u0430 \u0443\u0441\u043f\u0435\u0448\u043d\u043e \u043e\u0442\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u0430!\n\n\u041a\u0443\u0440\u0441 1 \u0444\u0430\u043a\u0443\u043b\u044c\u0442\u0435\u0442 \u0420\u0422\u0421: +\n\u041a\u0443\u0440\u0441 2 \u0444\u0430\u043a\u0443\u043b\u044c\u0442\u0435\u0442 \u0420\u0422\u0421: +\n\u041a\u0443\u0440\u0441 3 \u0444\u0430\u043a\u0443\u043b\u044c\u0442\u0435\u0442 \u0420\u0422\u0421: +-message_with_fwd] <- ../app/bot/tests/test_broadcast.py PASSED [  3%]
configs/bot/tests/test_broadcast.py::test_sharing_text[broadcast_result1-\u041d\u0435 \u0443\u0434\u0430\u043b\u043e\u0441\u044c \u043e\u0442\u043f\u0440\u0430\u0432\u0438\u0442\u044c \u0440\u0430\u0441\u0441\u044b\u043b\u043a\u0443.\n\n\u041a\u0443\u0440\u0441 1 \u0444\u0430\u043a\u0443\u043b\u044c\u0442\u0435\u0442 \u0418\u041a\u0421\u0421: -\n\u041a\u0443\u0440\u0441 2 \u0444\u0430\u043a\u0443\u043b\u044c\u0442\u0435\u0442 \u0418\u041a\u0421\u0421: -\n\u041a\u0443\u0440\u0441 3 \u0444\u0430\u043a\u0443\u043b\u044c\u0442\u0435\u0442 \u0418\u041a\u0421\u0421: --message_simple] <- ../app/bot/tests/test_broadcast.py PASSED [  4%]
configs/bot/tests/test_broadcast.py::test_sharing_text[broadcast_result1-\u041d\u0435 \u0443\u0434\u0430\u043b\u043e\u0441\u044c \u043e\u0442\u043f\u0440\u0430\u0432\u0438\u0442\u044c \u0440\u0430\u0441\u0441\u044b\u043b\u043a\u0443.\n\n\u041a\u0443\u0440\u0441 1 \u0444\u0430\u043a\u0443\u043b\u044c\u0442\u0435\u0442 \u0418\u041a\u0421\u0421: -\n\u041a\u0443\u0440\u0441 2 \u0444\u0430\u043a\u0443\u043b\u044c\u0442\u0435\u0442 \u0418\u041a\u0421\u0421: -\n\u041a\u0443\u0440\u0441 3 \u0444\u0430\u043a\u0443\u043b\u044c\u0442\u0435\u0442 \u0418\u041a\u0421\u0421: --message_with_reply] <- ../app/bot/tests/test_broadcast.py PASSED [  5%]
configs/bot/tests/test_broadcast.py::test_sharing_text[broadcast_result1-\u041d\u0435 \u0443\u0434\u0430\u043b\u043e\u0441\u044c \u043e\u0442\u043f\u0440\u0430\u0432\u0438\u0442\u044c \u0440\u0430\u0441\u0441\u044b\u043b\u043a\u0443.\n\n\u041a\u0443\u0440\u0441 1 \u0444\u0430\u043a\u0443\u043b\u044c\u0442\u0435\u0442 \u0418\u041a\u0421\u0421: -\n\u041a\u0443\u0440\u0441 2 \u0444\u0430\u043a\u0443\u043b\u044c\u0442\u0435\u0442 \u0418\u041a\u0421\u0421: -\n\u041a\u0443\u0440\u0441 3 \u0444\u0430\u043a\u0443\u043b\u044c\u0442\u0435\u0442 \u0418\u041a\u0421\u0421: --message_with_fwd] <- ../app/bot/tests/test_broadcast.py PASSED [  6%]
configs/bot/tests/test_broadcast.py::test_sharing_text[broadcast_result2-\u0420\u0430\u0441\u0441\u044b\u043b\u043a\u0430 \u043e\u0442\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u0430 \u043d\u0435 \u043f\u043e\u043b\u043d\u043e\u0441\u0442\u044c\u044e.\n\n\u041a\u0443\u0440\u0441 1 \u0444\u0430\u043a\u0443\u043b\u044c\u0442\u0435\u0442 \u0418\u0421\u0438\u0422: -\n\u041a\u0443\u0440\u0441 2 \u0444\u0430\u043a\u0443\u043b\u044c\u0442\u0435\u0442 \u0418\u0421\u0438\u0422: +\n\u041a\u0443\u0440\u0441 3 \u0444\u0430\u043a\u0443\u043b\u044c\u0442\u0435\u0442 \u0418\u0421\u0438\u0422: +-message_simple] <- ../app/bot/tests/test_broadcast.py PASSED [  7%]
configs/bot/tests/test_broadcast.py::test_sharing_text[broadcast_result2-\u0420\u0430\u0441\u0441\u044b\u043b\u043a\u0430 \u043e\u0442\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u0430 \u043d\u0435 \u043f\u043e\u043b\u043d\u043e\u0441\u0442\u044c\u044e.\n\n\u041a\u0443\u0440\u0441 1 \u0444\u0430\u043a\u0443\u043b\u044c\u0442\u0435\u0442 \u0418\u0421\u0438\u0422: -\n\u041a\u0443\u0440\u0441 2 \u0444\u0430\u043a\u0443\u043b\u044c\u0442\u0435\u0442 \u0418\u0421\u0438\u0422: +\n\u041a\u0443\u0440\u0441 3 \u0444\u0430\u043a\u0443\u043b\u044c\u0442\u0435\u0442 \u0418\u0421\u0438\u0422: +-message_with_reply] <- ../app/bot/tests/test_broadcast.py PASSED [  8%]
configs/bot/tests/test_broadcast.py::test_sharing_text[broadcast_result2-\u0420\u0430\u0441\u0441\u044b\u043b\u043a\u0430 \u043e\u0442\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u0430 \u043d\u0435 \u043f\u043e\u043b\u043d\u043e\u0441\u0442\u044c\u044e.\n\n\u041a\u0443\u0440\u0441 1 \u0444\u0430\u043a\u0443\u043b\u044c\u0442\u0435\u0442 \u0418\u0421\u0438\u0422: -\n\u041a\u0443\u0440\u0441 2 \u0444\u0430\u043a\u0443\u043b\u044c\u0442\u0435\u0442 \u0418\u0421\u0438\u0422: +\n\u041a\u0443\u0440\u0441 3 \u0444\u0430\u043a\u0443\u043b\u044c\u0442\u0435\u0442 \u0418\u0421\u0438\u0422: +-message_with_fwd] <- ../app/bot/tests/test_broadcast.py PASSED [  9%]
configs/bot/tests/test_broadcast.py::test_sharing_text_forbidden <- ../app/bot/tests/test_broadcast.py PASSED [ 10%]
configs/bot/tests/test_common.py::test_user_help_successful <- ../app/bot/tests/test_common.py PASSED [ 11%]
configs/bot/tests/test_common.py::test_user_help_not_admin <- ../app/bot/tests/test_common.py PASSED [ 12%]
configs/bot/tests/test_common.py::test_faculty_list_super_admin <- ../app/bot/tests/test_common.py PASSED [ 13%]
configs/bot/tests/test_common.py::test_faculty_list_not_super_admin <- ../app/bot/tests/test_common.py PASSED [ 15%]
configs/tests/test_broadcast.py::test_group_broadcast_successful <- ../app/tests/test_broadcast.py PASSED [ 16%]
configs/tests/test_broadcast.py::test_group_broadcast_permissions_failed <- ../app/tests/test_broadcast.py PASSED [ 17%]
configs/tests/test_broadcast.py::test_group_broadcast_failed <- ../app/tests/test_broadcast.py PASSED [ 18%]
configs/tests/test_broadcast.py::test_all_groups_broadcast_successful <- ../app/tests/test_broadcast.py PASSED [ 19%]
configs/tests/test_broadcast.py::test_all_groups_broadcast_permission_failed <- ../app/tests/test_broadcast.py PASSED [ 20%]
configs/tests/test_broadcast.py::test_all_groups_broadcast_failed <- ../app/tests/test_broadcast.py PASSED [ 21%]
configs/tests/test_broadcast.py::test_course_broadcast_empty <- ../app/tests/test_broadcast.py PASSED [ 22%]
configs/tests/test_broadcast.py::test_course_broadcast_exception <- ../app/tests/test_broadcast.py PASSED [ 23%]
configs/tests/test_broadcast.py::test_course_broadcast_successful <- ../app/tests/test_broadcast.py PASSED [ 24%]
configs/tests/test_broadcast.py::test_broadcast_empty <- ../app/tests/test_broadcast.py PASSED [ 25%]
configs/tests/test_broadcast.py::test_broadcast_successful <- ../app/tests/test_broadcast.py PASSED [ 26%]
configs/tests/test_broadcast.py::test_broadcast_not_numeric_error <- ../app/tests/test_broadcast.py PASSED [ 27%]
configs/tests/test_db.py::test_add_group <- ../app/tests/test_db.py PASSED [ 29%]
configs/tests/test_db.py::test_ids_by_course <- ../app/tests/test_db.py PASSED [ 30%]
configs/tests/test_db.py::test_delete_group <- ../app/tests/test_db.py PASSED [ 31%]
configs/tests/test_db.py::test_groups_ids <- ../app/tests/test_db.py PASSED [ 32%]
configs/tests/test_db.py::test_change_group_course <- ../app/tests/test_db.py PASSED [ 33%]
configs/tests/test_db.py::test_db_connect_raises_database_error <- ../app/tests/test_db.py PASSED [ 34%]
configs/tests/test_db.py::test_db_connect_raises_unexpected_error <- ../app/tests/test_db.py PASSED [ 35%]
configs/tests/test_db.py::test_add_message <- ../app/tests/test_db.py PASSED [ 36%]
configs/tests/test_db_admins.py::test_add_admin <- ../app/tests/test_db_admins.py PASSED [ 37%]
configs/tests/test_db_admins.py::test_get_all_admins <- ../app/tests/test_db_admins.py PASSED [ 38%]
configs/tests/test_db_admins.py::test_get_all_superusers <- ../app/tests/test_db_admins.py PASSED [ 39%]
configs/tests/test_db_admins.py::test_delete_admin <- ../app/tests/test_db_admins.py PASSED [ 40%]
configs/tests/test_db_admins.py::test_get_admin_by_id <- ../app/tests/test_db_admins.py PASSED [ 41%]
configs/tests/test_db_faculties.py::test_add_faculty <- ../app/tests/test_db_faculties.py PASSED [ 43%]
configs/tests/test_db_faculties.py::test_get_faculty_id <- ../app/tests/test_db_faculties.py PASSED [ 44%]
configs/tests/test_db_faculties.py::test_get_faculty_name <- ../app/tests/test_db_faculties.py PASSED [ 45%]
configs/tests/test_fastapi.py::test_callback_confirmation <- ../app/tests/test_fastapi.py PASSED [ 46%]
configs/tests/test_fastapi.py::test_callback_event <- ../app/tests/test_fastapi.py PASSED [ 47%]
configs/tests/test_utils.py::test_process_course[admin--1] <- ../app/tests/test_utils.py PASSED [ 48%]
configs/tests/test_utils.py::test_process_course[0-0] <- ../app/tests/test_utils.py PASSED [ 49%]
configs/tests/test_utils.py::test_process_course[1-1] <- ../app/tests/test_utils.py PASSED [ 50%]
configs/tests/test_utils.py::test_process_course[2-2] <- ../app/tests/test_utils.py PASSED [ 51%]
configs/tests/test_utils.py::test_process_course[3-3] <- ../app/tests/test_utils.py PASSED [ 52%]
configs/tests/test_utils.py::test_process_course[4-4] <- ../app/tests/test_utils.py PASSED [ 53%]
configs/tests/test_utils.py::test_process_course[5-5] <- ../app/tests/test_utils.py PASSED [ 54%]
configs/tests/test_utils.py::test_process_course[6-6] <- ../app/tests/test_utils.py PASSED [ 55%]
configs/tests/test_utils.py::test_process_course[hello-0] <- ../app/tests/test_utils.py PASSED [ 56%]
configs/tests/test_utils.py::test_handle_course_successful[admin--1] <- ../app/tests/test_utils.py PASSED [ 58%]
configs/tests/test_utils.py::test_handle_course_successful[0-False] <- ../app/tests/test_utils.py PASSED [ 59%]
configs/tests/test_utils.py::test_handle_course_successful[1-1] <- ../app/tests/test_utils.py PASSED [ 60%]
configs/tests/test_utils.py::test_handle_course_successful[2-2] <- ../app/tests/test_utils.py PASSED [ 61%]
configs/tests/test_utils.py::test_handle_course_successful[3-3] <- ../app/tests/test_utils.py PASSED [ 62%]
configs/tests/test_utils.py::test_handle_course_successful[4-4] <- ../app/tests/test_utils.py PASSED [ 63%]
configs/tests/test_utils.py::test_handle_course_successful[5-5] <- ../app/tests/test_utils.py PASSED [ 64%]
configs/tests/test_utils.py::test_handle_course_successful[6-False] <- ../app/tests/test_utils.py PASSED [ 65%]
configs/tests/test_utils.py::test_handle_course_successful[hello-False] <- ../app/tests/test_utils.py PASSED [ 66%]
configs/tests/test_utils.py::test_handle_course_no_groups <- ../app/tests/test_utils.py PASSED [ 67%]
configs/tests/test_utils.py::test_handle_group_successful[1-groups_ids0-expected0] <- ../app/tests/test_utils.py PASSED [ 68%]
configs/tests/test_utils.py::test_handle_group_successful[2-groups_ids1-expected1] <- ../app/tests/test_utils.py PASSED [ 69%]
configs/tests/test_utils.py::test_handle_group_successful[3-groups_ids2-expected2] <- ../app/tests/test_utils.py PASSED [ 70%]
configs/tests/test_utils.py::test_handle_group_successful[4-groups_ids3-expected3] <- ../app/tests/test_utils.py PASSED [ 72%]
configs/tests/test_utils.py::test_handle_admin_id_from_superuser[[id1920129|\u0410\u0434\u043c\u0438\u043d\u0438\u0441\u0442\u0440\u0430\u0442\u043e\u0440_\u0418\u041a\u0421\u0421]-True-123-1920129] <- ../app/tests/test_utils.py PASSED [ 73%]
configs/tests/test_utils.py::test_handle_admin_id_from_superuser[[id1212432122|\u0410\u0434\u043c\u0438\u043d\u0438\u0441\u0442\u0440\u0430\u0442\u043e\u0440_\u0420\u0422\u0421]-True-123-1212432122] <- ../app/tests/test_utils.py PASSED [ 74%]
configs/tests/test_utils.py::test_handle_admin_id_from_superuser[[id12345|Already_in_table]-False-123-False] <- ../app/tests/test_utils.py PASSED [ 75%]
configs/tests/test_utils.py::test_handle_admin_id_from_superuser[1-True-123-False] <- ../app/tests/test_utils.py PASSED [ 76%]
configs/tests/test_utils.py::test_handle_admin_id_from_superuser[[1212432122|\u0410\u0434\u043c\u0438\u043d\u0438\u0441\u0442\u0440\u0430\u0442\u043e\u0440_\u0418\u0421\u0418\u0422]-True-123-False] <- ../app/tests/test_utils.py PASSED [ 77%]
configs/tests/test_utils.py::test_handle_admin_id_from_superuser[@2012102-True-123-False] <- ../app/tests/test_utils.py PASSED [ 78%]
configs/tests/test_utils.py::test_handle_admin_id_from_superuser[11298192-True-123-False] <- ../app/tests/test_utils.py PASSED [ 79%]
configs/tests/test_utils.py::test_handle_admin_id_from_superuser[Name-True-123-False] <- ../app/tests/test_utils.py PASSED [ 80%]
configs/tests/test_utils.py::test_handle_admin_id_from_superuser[[id1920129|\u0410\u0434\u043c\u0438\u043d\u0438\u0441\u0442\u0440\u0430\u0442\u043e\u0440_\u0418\u041a\u0421\u0421]-True-321-False] <- ../app/tests/test_utils.py PASSED [ 81%]
configs/tests/test_utils.py::test_handle_admin_id_from_superuser[[id1212432122|\u0410\u0434\u043c\u0438\u043d\u0438\u0441\u0442\u0440\u0430\u0442\u043e\u0440_\u0420\u0422\u0421]-True-321-False] <- ../app/tests/test_utils.py PASSED [ 82%]
configs/tests/test_utils.py::test_handle_admin_id_from_superuser[[id12345|Already_in_table]-False-321-False] <- ../app/tests/test_utils.py PASSED [ 83%]
configs/tests/test_utils.py::test_handle_admin_id_from_superuser[1-True-321-False] <- ../app/tests/test_utils.py PASSED [ 84%]
configs/tests/test_utils.py::test_handle_admin_id_from_superuser[[1212432122|\u0410\u0434\u043c\u0438\u043d\u0438\u0441\u0442\u0440\u0430\u0442\u043e\u0440_\u0418\u0421\u0418\u0422]-True-321-False] <- ../app/tests/test_utils.py PASSED [ 86%]
configs/tests/test_utils.py::test_handle_admin_id_from_superuser[@2012102-True-321-False] <- ../app/tests/test_utils.py PASSED [ 87%]
configs/tests/test_utils.py::test_handle_admin_id_from_superuser[11298192-True-321-False] <- ../app/tests/test_utils.py PASSED [ 88%]
configs/tests/test_utils.py::test_handle_admin_id_from_superuser[Name-True-321-False] <- ../app/tests/test_utils.py PASSED [ 89%]
configs/tests/test_utils.py::test_handle_faculty[text-\u0420\u0422\u0421-expected0] <- ../app/tests/test_utils.py PASSED [ 90%]
configs/tests/test_utils.py::test_handle_faculty[text123-\u0441\u0443\u043f\u0435\u0440\u0430\u0434\u043c\u0438\u043d-expected1] <- ../app/tests/test_utils.py PASSED [ 91%]
configs/tests/test_utils.py::test_handle_faculty[text none-\u0421\u041f\u0411\u041a\u0422-expected2] <- ../app/tests/test_utils.py PASSED [ 92%]
configs/tests/test_utils.py::test_make_pairs[courses0-\u0420\u0422\u0421 \u0421\u041f\u0431\u041a\u0422 \u0418\u041a\u0421\u0421-expected0] <- ../app/tests/test_utils.py PASSED [ 93%]
configs/tests/test_utils.py::test_make_pairs[courses1-None-expected1] <- ../app/tests/test_utils.py PASSED [ 94%]
configs/tests/test_utils.py::test_make_pairs[courses2-\u0412\u0423\u0426 \u0418\u0421\u0438\u0422-expected2] <- ../app/tests/test_utils.py PASSED [ 95%]
configs/tests/test_utils.py::test_proc_course <- ../app/tests/test_utils.py PASSED [ 96%]
configs/tests/test_utils.py::test_is_valid_id_format <- ../app/tests/test_utils.py PASSED [ 97%]
configs/tests/test_utils.py::test_extract_id <- ../app/tests/test_utils.py PASSED [ 98%]
configs/tests/test_utils.py::test_parse_add_regex <- ../app/tests/test_utils.py PASSED [100%]

---------- coverage: platform linux, python 3.11.3-final-0 -----------
Coverage HTML written to dir artifacts/cov_report/

FAIL Required test coverage of 90.0% not reached. Total coverage: 79.68%

======================== 93 passed, 1 warning in 7.52s =========================
